package jdbc;

import java.sql.*;
import java.util.*;

public class JDBC {

	public static Connection getConnection() throws SQLException {

		Connection connection = null;

		try {

			// loading the driver
			Class.forName("com.mysql.cj.jdbc.Driver");

			// connection creation
			connection = DriverManager.getConnection(
					"jdbc:mysql://localhost:3306/store_front", "root", "root");

			// statement creation
			Statement statement = connection.createStatement();

			// query execution
			ResultSet rs = statement.executeQuery("SELECT product_id FROM products");
			ResultSetMetaData resultSet = rs.getMetaData();
			System.out.println(resultSet);
			 int columnsNumber = resultSet.getColumnCount();
			   while (rs.next()) {
			       for (int i = 1; i <= columnsNumber; i++) {
			           if (i > 1) System.out.print(",  ");
			           String columnValue = rs.getString(i);
			           System.out.print(columnValue + " " + resultSet.getColumnName(i));
			       }
			   }

			connection.close();
		} catch (Exception e) {
			System.out.println(e);
		}
		return connection;
	}

}